<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>对生命游戏进行梯度下降 | Miuchan</title>
  <meta name="description" content="把生命游戏松弛为可导系统：定义软规则、构建损失、设计梯度下降流程，并讨论数值技巧与收敛策略。">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../assets/main.css">
  <style>
    main.article {
      max-width: 760px;
      margin: 64px auto 120px;
      background: rgba(15, 23, 42, 0.55);
      border: 1px solid var(--card-border);
      border-radius: 28px;
      padding: 48px 56px;
      box-shadow: var(--shadow);
    }
    main.article header h1 {
      margin: 0 0 12px;
      font-size: clamp(2.2rem, 4vw, 2.8rem);
      font-weight: 800;
      letter-spacing: -0.015em;
    }
    main.article header p.meta {
      margin: 0;
      color: var(--muted);
      font-size: 0.95rem;
    }
    main.article section {
      margin-top: 40px;
    }
    main.article h2 {
      margin: 0 0 16px;
      font-size: 1.5rem;
    }
    main.article p {
      color: #e2e8f0;
      margin: 0 0 18px;
      text-align: justify;
    }
    main.article ul {
      margin: 0 0 18px 20px;
      color: #e2e8f0;
      padding-left: 16px;
    }
    main.article li + li {
      margin-top: 8px;
    }
    main.article .quote {
      margin: 24px 0;
      padding: 18px 24px;
      border-left: 3px solid var(--accent);
      background: rgba(59, 130, 246, 0.12);
      color: #bfdbfe;
      border-radius: 0 18px 18px 0;
    }
    main.article code {
      font-family: 'Source Code Pro', 'JetBrains Mono', monospace;
      background: rgba(148, 163, 184, 0.15);
      padding: 2px 6px;
      border-radius: 6px;
      font-size: 0.9rem;
    }
    main.article figure {
      margin: 28px 0;
      padding: 20px 24px;
      background: rgba(30, 41, 59, 0.6);
      border-radius: 20px;
      border: 1px solid rgba(148, 163, 184, 0.2);
    }
    main.article figure figcaption {
      margin-top: 12px;
      color: var(--muted);
      font-size: 0.9rem;
      text-align: center;
    }
    nav.article-nav {
      display: flex;
      justify-content: space-between;
      margin-top: 48px;
      font-size: 0.95rem;
      color: var(--muted);
    }
    nav.article-nav a {
      color: var(--text);
    }
    @media (max-width: 768px) {
      main.article {
        margin: 32px 0 80px;
        padding: 32px 24px;
        border-radius: 22px;
      }
      nav.article-nav {
        flex-direction: column;
        gap: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <nav>
      <a href="../index.html" class="logo">miuchan.github.io</a>
      <div class="nav-links">
        <a href="../index.html#about">关于</a>
        <a href="../index.html#projects">作品</a>
        <a href="../index.html#writing">写作</a>
        <a href="../index.html#contact">联系</a>
      </div>
    </nav>

    <main class="article">
      <header>
        <h1>对生命游戏进行梯度下降</h1>
        <p class="meta">2024 年 6 月 · 复杂系统 / 数值实验笔记</p>
      </header>

      <section>
        <p>在康威生命游戏里，简单的局部规则能涌现出惊人的复杂度：滑翔子会穿越棋盘、振荡子保持节奏、枪炮结构自发生成无限序列。若我们希望“设计”这些结构，仅靠穷举搜索往往效率低下。一个更可控的思路是把生命游戏松弛成可导系统，让我们能够对目标模式构建损失函数，并用梯度下降优化初始状态或外部干预。</p>
        <div class="quote">对生命游戏进行梯度下降的关键不在于直接优化离散格点，而是用平滑近似让演化可导，在连续空间里下降，再将解投影回二值世界。</div>
      </section>

      <section>
        <h2>1. 让规则可导：软邻居统计与激活函数</h2>
        <p>生命游戏的基本变量是格点 <code>(i, j, t)</code> 的存活状态 <code>x_{i,j}^t \in \{0,1\}</code>。为了使用梯度法，我们把状态松弛为区间变量 <code>y_{i,j}^t \in [0,1]</code>，并将局部规则改写为平滑函数。常见做法包括：</p>
        <ul>
          <li><strong>软邻居计数</strong>：使用卷积核 <code>k</code> 对上一帧状态做加权求和，得到连续的邻居数量 <code>s_{i,j}^t</code>。</li>
          <li><strong>平滑阈值</strong>：用 Sigmoid 或 Softplus 函数近似“等于 2 或 3 则存活、等于 3 则诞生”的离散规则，例如 <code>\sigma(\alpha (s-2.5))</code>。</li>
          <li><strong>温度调节</strong>：通过调整平滑参数 <code>\alpha</code> 控制规则的锐利程度，训练初期使用较低温度保证梯度存在，后期逐渐升温逼近原规则。</li>
        </ul>
        <p>这样得到的演化函数 <code>\tilde{G}(y^{t-1})</code> 虽然只是原规则的软近似，但它是处处可导的，从而允许反向传播。</p>
      </section>

      <section>
        <h2>2. 构建损失：从目标帧到时序约束</h2>
        <p>有了可导的演化，我们可以为不同任务设计损失函数：</p>
        <ul>
          <li><strong>目标重建</strong>：给定目标帧 <code>\hat{x}^T</code>，最小化终态误差 <code>\|y^T - \hat{x}^T\|_2^2</code>，反向传播以优化初始状态 <code>y^0</code>。</li>
          <li><strong>轨迹约束</strong>：如果希望中间帧遵循既定路径，可对每个时间步加入重建损失，或设置“关键帧”施加更高权重。</li>
          <li><strong>正则项</strong>：添加 <code>\lambda \sum_{i,j,t} y_{i,j}^t (1 - y_{i,j}^t)</code> 鼓励二值化，或用总变差惩罚保持结构边界清晰。</li>
        </ul>
        <p>损失的设计直接影响梯度方向。过于尖锐的指标可能导致梯度消失，因此我们通常混合平滑的 <code>\ell_2</code> 项与离散化惩罚。</p>
      </section>

      <section>
        <h2>3. 优化流程：前向演化与反向传播</h2>
        <p>梯度下降的核心是把生命游戏视作一个参数化的计算图。典型流程如下：</p>
        <ol>
          <li><strong>前向推理</strong>：从初始状态 <code>y^0</code> 出发，迭代应用软规则 <code>y^{t} = \tilde{G}(y^{t-1})</code> 得到整条轨迹。</li>
          <li><strong>损失评估</strong>：根据任务定义计算总损失 <code>\mathcal{L}(y^0, \ldots, y^T)</code>。</li>
          <li><strong>反向传播</strong>：利用自动微分计算梯度 <code>\nabla_{y^0} \mathcal{L}</code>，或对外部控制量 <code>u^t</code> 计算梯度。</li>
          <li><strong>梯度更新</strong>：采用优化器（SGD、Adam、RMSprop）对参数进行更新，并对状态裁剪至 <code>[0,1]</code> 区间。</li>
          <li><strong>投影与验证</strong>：在若干迭代后将状态阈值化，重新用原生命规则验证是否得到目标结构。</li>
        </ol>
        <p>这一流程本质上是把生命游戏当作可微分的动力系统，梯度通过时间反向传播，指导我们修改初始条件。</p>
      </section>

      <section>
        <h2>4. 数值技巧：稳定梯度与收敛</h2>
        <p>直接反向传播可能面临梯度爆炸或消失。以下技巧有助于提升稳定性：</p>
        <ul>
          <li><strong>截断 BPTT</strong>：将时间展开截断为较短的窗口，减轻梯度在长序列中的衰减。</li>
          <li><strong>学习率调度</strong>：使用余弦退火或自适应优化器，在靠近目标时降低步长，避免震荡。</li>
          <li><strong>温度退火</strong>：逐渐增大规则的平滑参数 <code>\alpha</code>，让优化先在温和的景观中找到可行区域，再收紧逼近离散规则。</li>
          <li><strong>噪声注入</strong>：在前向过程中加入小噪声，帮助优化逃离局部极小值，并提升离散投影后的鲁棒性。</li>
        </ul>
        <p>这些策略与训练神经网络类似：我们不仅要关心目标函数，还要关注梯度流的形态。</p>
      </section>

      <section>
        <h2>5. 控制扩展：优化外部干预</h2>
        <p>除了调整初始状态，我们还可以在每个时间步引入可控变量 <code>u^t</code>，表示强制点亮或熄灭的格点。损失中加入 <code>\gamma \|u\|_1</code> 惩罚，使得梯度下降在达到目标结构的同时，尽量减少干预次数。</p>
        <p>优化后的控制序列可以用来构造“操控脚本”：在真实的生命游戏中只需按脚本干预，就能把系统推向预期的振荡子或滑翔子。这一框架也方便分析敏感度——梯度告诉我们哪些格点最影响目标，从而指导结构设计。</p>
      </section>

      <section>
        <h2>6. 总结</h2>
        <p>生命游戏的魅力在于简单规则下的无限可能。通过软化规则、构建损失并执行梯度下降，我们得以在连续空间里探索这些可能性，再投影回离散世界验证。虽然松弛带来了近似误差，但它让我们能系统地设计初始状态、规划干预，并量化不同结构的敏感度。</p>
        <p>与其盲目搜索，不如搭建一个可微的生命游戏框架：让梯度指引我们雕刻模式，在无限涌现的舞台上实现可控的创作。</p>
      </section>

      <nav class="article-nav">
        <span><a href="internet-of-everything-design.html">← 万物互联的设计与实现</a></span>
        <span><a href="ctc-convex-optimization.html">理解封闭类时曲线凸优化的本质 →</a></span>
      </nav>
    </main>
  </div>
</body>
</html>
